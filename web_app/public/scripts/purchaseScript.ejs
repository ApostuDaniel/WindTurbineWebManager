<script>
    async function makeOffer(buyerId, sellerId, turbineId) {
        if(buyerId !== sellerId) {
            const existence = await checkIfExists(buyerId, turbineId);
            if(existence === false) {
                console.log("Creating");
                await createNotification(buyerId, sellerId, turbineId);
            }
        }
    }

    async function checkIfExists(buyerId, turbineId) {
        const notifications_api_url = "http://localhost:5000/api/users/notifications";
        const data = await fetch (notifications_api_url);
        const notifications = await data.json();
        console.log(notifications);
        for(notification of notifications) {
            if(notification.idBuyer === buyerId && notification.idTurbine === turbineId) {
                console.log("Offer already made");
                return true;
            }
        }

        return false;
    }

    async function createNotification(buyerId, sellerId, turbineId) {
        const post_notification_api_url = "http://localhost:5000/api/users/notifications";

        const requestBody = {
            idBuyer: buyerId,
            idSeller: sellerId,
            idTurbine: turbineId
        };

        const response = await fetch(post_notification_api_url, {
            method: "POST",
            body: JSON.stringify(requestBody)
        });
    }
</script>